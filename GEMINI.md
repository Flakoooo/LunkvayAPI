# Обзор проекта LunkvayAPI

Этот проект представляет собой веб-API на C# .NET 9.0 под названием "LunkvayAPI". Он служит бэкендом для чат-приложения, включая такие функции, как аутентификация пользователя (JWT Bearer), управление профилями, аватарами и функциями дружбы. Приложение использует MySQL в качестве основного хранилища данных, управляемого через Entity Framework Core. Обработка изображений для аватаров и изображений чата осуществляется с помощью `SixLabors.ImageSharp` с сохранением в локальной файловой системе. Проект контейнеризован с использованием Docker.

## Используемые технологии

*   **Бэкенд:** C#, .NET 9.0, ASP.NET Core Web API
*   **База данных:** MySQL (через Pomelo.EntityFrameworkCore.MySql)
*   **ORM:** Entity Framework Core
*   **Аутентификация:** JWT Bearer
*   **Общение в реальном времени:** SignalR
*   **Обработка изображений:** SixLabors.ImageSharp
*   **Хранение файлов:** Локальная файловая система (в директории `/Media`)
*   **Контейнеризация:** Docker, Docker Compose

## Сборка и запуск

### Использование Docker Compose (Рекомендуется)

Приложение можно запустить с помощью Docker Compose, который настроит как API, так и базу данных MySQL.

1.  **Переменные окружения:** Убедитесь, что у вас есть файл `.env` в корневом каталоге со следующими переменными:
    *   `JWT_KEY`: Секретный ключ для генерации токенов JWT.
    *   `JWT_ISSUER`: Эмитент для токенов JWT.
    *   `DB_NAME`: Имя базы данных MySQL.
    *   `DB_USER`: Пользователь базы данных MySQL.
    *   `DB_PASSWORD`: Пароль пользователя базы данных MySQL.

2.  **Запуск в режиме разработки:**
    ```bash
    docker-compose -f dev-docker-compose.yml up --build
    ```
    API будет доступен по адресу `http://localhost:8080`. Директория `./Media` будет смонтирована в контейнер для хранения файлов.

### Без Docker (CLI dotnet)

1.  **Настройте `appsettings.Development.json`:** Укажите правильную строку подключения к базе данных и настройки JWT.

2.  **Восстановление и сборка:**
    ```bash
    dotnet restore
    dotnet build mainapi/LunkvayAPI.csproj
    ```

3.  **Миграции базы данных:**
    ```bash
    dotnet ef database update --project mainapi/LunkvayAPI.csproj
    ```

4.  **Запуск приложения:**
    ```bash
    dotnet run --project mainapi/LunkvayAPI.csproj
    ```

## Соглашения о разработке

*   **Стиль кодирования:** Соответствует соглашениям о кодировании C#, определенным в `.editorconfig`.
*   **Обработка ошибок:** Глобальная обработка исключений реализована через `GlobalExceptionFilter`.
*   **Аутентификация:** Авторизация обеспечивается с помощью `AuthorizationFilter`, который извлекает `UserId` из JWT токена.
*   **Документация API:** Использует Scalar для документации API, доступной по адресу `/swagger` при работающем приложении.